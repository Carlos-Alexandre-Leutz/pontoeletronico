{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth } from \"firebase/auth\";\nimport { getDatabase, get, ref, push, set } from \"firebase/database\";\nexport default {\n  data() {\n    return {\n      registros: []\n    };\n  },\n  methods: {\n    async iniciarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n      try {\n        let dataAtual = new Date();\n        let objetoDataHora = {\n          data: {\n            dia: dataAtual.getDate(),\n            mes: dataAtual.getMonth() + 1,\n            ano: dataAtual.getFullYear()\n          },\n          horaInicio: {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes()\n          },\n          horaFim: {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes()\n          },\n          tarefas: []\n        };\n        const novoRegistro = {\n          data: objetoDataHora,\n          tarefas: [{\n            tarefa: \"asd\"\n          }]\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid\n        });\n        console.log(\"Registro de ponto salvo com sucesso:\", novoRegistroRef.key);\n\n        // Atualiza a lista de registros na interface do usuário\n        this.registros.push({\n          ...novoRegistro,\n          id: novoRegistroRef.key\n        });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    },\n    async pararPonto(registroId, registro) {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      const db = getDatabase();\n      const pontoRef = ref(db, `pontos/${registroId}`);\n      try {\n        if (registro.userId === user.uid) {\n          // Atualiza a propriedade horaFim para a data atual\n          let dataAtual = new Date();\n          registro.data.horaFim = {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes()\n          };\n\n          // Atualiza o registro no Firebase\n          await set(pontoRef, registro);\n          console.log(\"Registro de ponto finalizado com sucesso:\", registroId);\n\n          // // Atualiza a lista de registros na interface do usuário\n          // const index = this.registros.findIndex((r) => r.id === registroId);\n          // this.$set(this.registros, index, { ...registro, id: registroId });\n        } else {\n          console.warn(\"O registro não pertence ao usuário atual.\");\n        }\n      } catch (error) {\n        console.error(\"Erro ao finalizar ponto:\", error.message);\n      }\n    },\n    async adiconarTarefa(registroId, registro) {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      const db = getDatabase();\n      const pontoRef = ref(db, `pontos/${registroId}`);\n      try {\n        if (registro.userId === user.uid) {\n          // Atualiza a propriedade horaFim para a data atual\n          let dataAtual = new Date();\n          const tarefa = {\n            descricao: \"tarefa nome\",\n            horaInicio: {\n              horas: dataAtual.getHours(),\n              minutos: dataAtual.getMinutes()\n            },\n            horaFim: {\n              horas: dataAtual.getHours(),\n              minutos: dataAtual.getMinutes()\n            }\n          };\n          console.log(registro.data);\n          registro.tarefas.push(tarefa);\n          // Atualiza o registro no Firebase\n          await set(pontoRef, registro);\n          console.log(\"Registro de ponto finalizado com sucesso:\", registroId);\n\n          // // Atualiza a lista de registros na interface do usuário\n          // const index = this.registros.findIndex((r) => r.id === registroId);\n          // this.$set(this.registros, index, { ...registro, id: registroId });\n        } else {\n          console.warn(\"O registro não pertence ao usuário atual.\");\n        }\n      } catch (error) {\n        console.error(\"Erro ao finalizar ponto:\", error.message);\n      }\n    },\n    timeSpentTask(objetoDataHora) {\n      let dataInicio = new Date();\n      dataInicio.setHours(objetoDataHora.horaInicio.horas);\n      dataInicio.setMinutes(objetoDataHora.horaInicio.minutos);\n      let dataFim = new Date();\n      dataFim.setHours(objetoDataHora.horaFim.horas);\n      dataFim.setMinutes(objetoDataHora.horaFim.minutos);\n\n      // Calculando a diferença em milissegundos\n      let diferencaEmMilissegundos = dataFim - dataInicio;\n\n      // Convertendo a diferença para minutos\n      let diferencaEmMinutos = diferencaEmMilissegundos / (1000 * 60);\n      return diferencaEmMinutos;\n    },\n    async pausarPonto() {}\n  },\n  async created() {\n    const db = getDatabase();\n    const pontoRef = ref(db, \"pontos\");\n\n    // Consulta os registros de ponto do usuário no Realtime Database\n    // Este exemplo apenas carrega os últimos 10 registros, você pode ajustar conforme necessário\n    const snapshot = await get(pontoRef, \"value\");\n    const registros = [];\n    if (snapshot.exists()) {\n      snapshot.forEach(childSnapshot => {\n        const key = childSnapshot.key;\n        const data = childSnapshot.val();\n        registros.push({\n          key,\n          ...data\n        });\n      });\n    }\n    this.registros = registros;\n  }\n};","map":{"version":3,"names":["getAuth","getDatabase","get","ref","push","set","data","registros","methods","iniciarPonto","auth","user","currentUser","db","pontoRef","dataAtual","Date","objetoDataHora","dia","getDate","mes","getMonth","ano","getFullYear","horaInicio","horas","getHours","minutos","getMinutes","horaFim","tarefas","novoRegistro","tarefa","novoRegistroRef","userId","uid","console","log","key","id","error","message","pararPonto","registroId","registro","warn","adiconarTarefa","descricao","timeSpentTask","dataInicio","setHours","setMinutes","dataFim","diferencaEmMilissegundos","diferencaEmMinutos","pausarPonto","created","snapshot","exists","forEach","childSnapshot","val"],"sources":["/home/alexandre/code/ponto-eletronico/src/components/ClockInClockOut.vue"],"sourcesContent":["<!-- PontoEletronico.vue -->\n<template>\n  <div>\n    <h1>Marcação de Ponto Eletrônico</h1>\n    <button @click=\"iniciarPonto\">Iniciar Dia</button>\n    <button @click=\"pararPonto\">Finalizar Dia</button>\n    <button @click=\"pausarPonto\">Pausar</button>\n    <div v-for=\"registro in registros\" :key=\"registro.userId\" class=\"col-md-12\">\n      <div class=\"card\">\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">\n            Dia: {{ registro.data.data.dia }}/{{ registro.data.data.mes }}/{{\n              registro.data.data.ano\n            }}\n          </h5>\n          <br />\n          hora inicio: {{ registro.data.horaInicio.horas }}:{{\n            registro.data.horaInicio.minutos\n          }}\n          <br />\n          <template v-if=\"timeSpentTask(registro.data)\">\n            Hora fim: {{ registro.data.horaFim.horas }}:{{\n              registro.data.horaFim.minutos\n            }}\n            <br />\n          </template>\n          Tempo gasto: {{ timeSpentTask(registro.data) }}\n          <template v-if=\"!timeSpentTask(registro.data)\">\n            <button @click=\"pararPonto(registro.key, registro)\">\n              Finalizar\n            </button>\n          </template>\n          <button @click=\"adiconarTarefa(registro.key, registro)\">\n            adiconar Tarefa\n          </button>\n          <div v-for=\"tarefa in registro.tarefas\" :key=\"tarefa\">\n            {{ tarefa.descricao }}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getAuth } from \"firebase/auth\";\nimport { getDatabase, get, ref, push, set } from \"firebase/database\";\n\nexport default {\n  data() {\n    return {\n      registros: [],\n    };\n  },\n  methods: {\n    async iniciarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n\n      try {\n        let dataAtual = new Date();\n        let objetoDataHora = {\n          data: {\n            dia: dataAtual.getDate(),\n            mes: dataAtual.getMonth() + 1,\n            ano: dataAtual.getFullYear(),\n          },\n          horaInicio: {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes(),\n          },\n          horaFim: {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes(),\n          },\n          tarefas: [],\n        };\n\n        const novoRegistro = {\n          data: objetoDataHora,\n          tarefas: [{ tarefa: \"asd\" }],\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid,\n        });\n\n        console.log(\n          \"Registro de ponto salvo com sucesso:\",\n          novoRegistroRef.key\n        );\n\n        // Atualiza a lista de registros na interface do usuário\n        this.registros.push({ ...novoRegistro, id: novoRegistroRef.key });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    },\n    async pararPonto(registroId, registro) {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      const db = getDatabase();\n      const pontoRef = ref(db, `pontos/${registroId}`);\n\n      try {\n        if (registro.userId === user.uid) {\n          // Atualiza a propriedade horaFim para a data atual\n          let dataAtual = new Date();\n          registro.data.horaFim = {\n            horas: dataAtual.getHours(),\n            minutos: dataAtual.getMinutes(),\n          };\n\n          // Atualiza o registro no Firebase\n          await set(pontoRef, registro);\n\n          console.log(\"Registro de ponto finalizado com sucesso:\", registroId);\n\n          // // Atualiza a lista de registros na interface do usuário\n          // const index = this.registros.findIndex((r) => r.id === registroId);\n          // this.$set(this.registros, index, { ...registro, id: registroId });\n        } else {\n          console.warn(\"O registro não pertence ao usuário atual.\");\n        }\n      } catch (error) {\n        console.error(\"Erro ao finalizar ponto:\", error.message);\n      }\n    },\n    async adiconarTarefa(registroId, registro) {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      const db = getDatabase();\n      const pontoRef = ref(db, `pontos/${registroId}`);\n\n      try {\n        if (registro.userId === user.uid) {\n          // Atualiza a propriedade horaFim para a data atual\n          let dataAtual = new Date();\n\n          const tarefa = {\n            descricao: \"tarefa nome\",\n            horaInicio: {\n              horas: dataAtual.getHours(),\n              minutos: dataAtual.getMinutes(),\n            },\n            horaFim: {\n              horas: dataAtual.getHours(),\n              minutos: dataAtual.getMinutes(),\n            },\n          };\n          console.log(registro.data);\n          registro.tarefas.push(tarefa);\n          // Atualiza o registro no Firebase\n          await set(pontoRef, registro);\n\n          console.log(\"Registro de ponto finalizado com sucesso:\", registroId);\n\n          // // Atualiza a lista de registros na interface do usuário\n          // const index = this.registros.findIndex((r) => r.id === registroId);\n          // this.$set(this.registros, index, { ...registro, id: registroId });\n        } else {\n          console.warn(\"O registro não pertence ao usuário atual.\");\n        }\n      } catch (error) {\n        console.error(\"Erro ao finalizar ponto:\", error.message);\n      }\n    },\n    timeSpentTask(objetoDataHora) {\n      let dataInicio = new Date();\n      dataInicio.setHours(objetoDataHora.horaInicio.horas);\n      dataInicio.setMinutes(objetoDataHora.horaInicio.minutos);\n\n      let dataFim = new Date();\n      dataFim.setHours(objetoDataHora.horaFim.horas);\n      dataFim.setMinutes(objetoDataHora.horaFim.minutos);\n\n      // Calculando a diferença em milissegundos\n      let diferencaEmMilissegundos = dataFim - dataInicio;\n\n      // Convertendo a diferença para minutos\n      let diferencaEmMinutos = diferencaEmMilissegundos / (1000 * 60);\n\n      return diferencaEmMinutos;\n    },\n    async pausarPonto() {},\n  },\n  async created() {\n    const db = getDatabase();\n    const pontoRef = ref(db, \"pontos\");\n\n    // Consulta os registros de ponto do usuário no Realtime Database\n    // Este exemplo apenas carrega os últimos 10 registros, você pode ajustar conforme necessário\n    const snapshot = await get(pontoRef, \"value\");\n    const registros = [];\n\n    if (snapshot.exists()) {\n      snapshot.forEach((childSnapshot) => {\n        const key = childSnapshot.key;\n        const data = childSnapshot.val();\n        registros.push({ key, ...data });\n      });\n    }\n\n    this.registros = registros;\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth } from \"firebase/auth\";\nimport { getDatabase, ref, push, set } from \"firebase/database\";\nimport { getStorage, uploadString, getDownloadURL } from \"firebase/storage\";\nexport default {\n  data() {\n    return {\n      registros: [],\n      arquivo: null\n    };\n  },\n  methods: {\n    handleFileUpload(event) {\n      this.arquivo = event.target.files[0];\n    },\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      if (!user || !this.arquivo) {\n        console.error(\"Usuário não autenticado ou nenhum arquivo selecionado\");\n        return;\n      }\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n      try {\n        const novoRegistro = {\n          dataHora: new Date().toISOString(),\n          status: \"Marcado\"\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid\n        });\n        console.log(\"Registro de ponto salvo com sucesso:\", novoRegistroRef.key);\n\n        // Salva o arquivo no Storage\n        const storage = getStorage();\n        const storagePath = `ponto-eletronico/${user.uid}/${novoRegistroRef.key}.txt`;\n        const storageRef = storageRef(storage, storagePath);\n        await uploadString(storageRef, \"Conteúdo do arquivo\");\n\n        // Obtém o URL de download do arquivo no Storage\n        const downloadUrl = await getDownloadURL(storageRef);\n\n        // Atualiza a lista de registros na interface do usuário com o URL de download\n        this.registros.push({\n          ...novoRegistro,\n          id: novoRegistroRef.key,\n          downloadUrl\n        });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    }\n  }\n};","map":{"version":3,"names":["getAuth","getDatabase","ref","push","set","getStorage","uploadString","getDownloadURL","data","registros","arquivo","methods","handleFileUpload","event","target","files","marcarPonto","auth","user","currentUser","console","error","db","pontoRef","novoRegistro","dataHora","Date","toISOString","status","novoRegistroRef","userId","uid","log","key","storage","storagePath","storageRef","downloadUrl","id","message"],"sources":["/home/alexandre/code/ponto-eletronico/src/components/ClockInClockOut.vue"],"sourcesContent":["<!-- PontoEletronico.vue -->\n<template>\n  <div>\n    <h1>Marcação de Ponto Eletrônico</h1>\n    <input type=\"file\" @change=\"handleFileUpload\" />\n    <button @click=\"marcarPonto\">Marcar Ponto</button>\n    <ul>\n      <li v-for=\"registro in registros\" :key=\"registro.id\">\n        {{ registro.dataHora }} - {{ registro.status }} -\n        {{ registro.downloadUrl }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getAuth } from \"firebase/auth\";\nimport { getDatabase, ref, push, set } from \"firebase/database\";\nimport {\n  getStorage,\n  uploadString,\n  getDownloadURL,\n} from \"firebase/storage\";\n\nexport default {\n  data() {\n    return {\n      registros: [],\n      arquivo: null,\n    };\n  },\n  methods: {\n    handleFileUpload(event) {\n      this.arquivo = event.target.files[0];\n    },\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      if (!user || !this.arquivo) {\n        console.error(\"Usuário não autenticado ou nenhum arquivo selecionado\");\n        return;\n      }\n\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n\n      try {\n        const novoRegistro = {\n          dataHora: new Date().toISOString(),\n          status: \"Marcado\",\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid,\n        });\n\n        console.log(\n          \"Registro de ponto salvo com sucesso:\",\n          novoRegistroRef.key\n        );\n\n        // Salva o arquivo no Storage\n        const storage = getStorage();\n        const storagePath = `ponto-eletronico/${user.uid}/${novoRegistroRef.key}.txt`;\n        const storageRef = storageRef(storage, storagePath);\n        await uploadString(storageRef, \"Conteúdo do arquivo\");\n\n        // Obtém o URL de download do arquivo no Storage\n        const downloadUrl = await getDownloadURL(storageRef);\n\n        // Atualiza a lista de registros na interface do usuário com o URL de download\n        this.registros.push({\n          ...novoRegistro,\n          id: novoRegistroRef.key,\n          downloadUrl,\n        });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    },\n  },\n};\n</script>\n"],"mappings":";AAgBA,SAASA,OAAM,QAAS,eAAe;AACvC,SAASC,WAAW,EAAEC,GAAG,EAAEC,IAAI,EAAEC,GAAE,QAAS,mBAAmB;AAC/D,SACEC,UAAU,EACVC,YAAY,EACZC,cAAc,QACT,kBAAkB;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE;IACX,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,gBAAgBA,CAACC,KAAK,EAAE;MACtB,IAAI,CAACH,OAAM,GAAIG,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IACtC,CAAC;IACD,MAAMC,WAAWA,CAAA,EAAG;MAClB,MAAMC,IAAG,GAAIjB,OAAO,CAAC,CAAC;MACtB,MAAMkB,IAAG,GAAID,IAAI,CAACE,WAAW;MAE7B,IAAI,CAACD,IAAG,IAAK,CAAC,IAAI,CAACR,OAAO,EAAE;QAC1BU,OAAO,CAACC,KAAK,CAAC,uDAAuD,CAAC;QACtE;MACF;MAEA,MAAMC,EAAC,GAAIrB,WAAW,CAAC,CAAC;MACxB,MAAMsB,QAAO,GAAIrB,GAAG,CAACoB,EAAE,EAAE,QAAQ,CAAC;MAElC,IAAI;QACF,MAAME,YAAW,GAAI;UACnBC,QAAQ,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;UAClCC,MAAM,EAAE;QACV,CAAC;;QAED;QACA,MAAMC,eAAc,GAAI1B,IAAI,CAACoB,QAAQ,CAAC;QACtC,MAAMnB,GAAG,CAACyB,eAAe,EAAE;UACzB,GAAGL,YAAY;UACfM,MAAM,EAAEZ,IAAI,CAACa;QACf,CAAC,CAAC;QAEFX,OAAO,CAACY,GAAG,CACT,sCAAsC,EACtCH,eAAe,CAACI,GAClB,CAAC;;QAED;QACA,MAAMC,OAAM,GAAI7B,UAAU,CAAC,CAAC;QAC5B,MAAM8B,WAAU,GAAK,oBAAmBjB,IAAI,CAACa,GAAI,IAAGF,eAAe,CAACI,GAAI,MAAK;QAC7E,MAAMG,UAAS,GAAIA,UAAU,CAACF,OAAO,EAAEC,WAAW,CAAC;QACnD,MAAM7B,YAAY,CAAC8B,UAAU,EAAE,qBAAqB,CAAC;;QAErD;QACA,MAAMC,WAAU,GAAI,MAAM9B,cAAc,CAAC6B,UAAU,CAAC;;QAEpD;QACA,IAAI,CAAC3B,SAAS,CAACN,IAAI,CAAC;UAClB,GAAGqB,YAAY;UACfc,EAAE,EAAET,eAAe,CAACI,GAAG;UACvBI;QACF,CAAC,CAAC;MACJ,EAAE,OAAOhB,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAACkB,OAAO,CAAC;MACvD;IACF;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
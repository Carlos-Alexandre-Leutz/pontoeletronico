{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth } from \"firebase/auth\";\nimport { getDatabase, ref, push, set, serverTimestamp } from \"firebase/database\";\nexport default {\n  data() {\n    return {\n      registros: []\n    };\n  },\n  methods: {\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      if (!user) {\n        console.error(\"Usuário não autenticado\");\n        return;\n      }\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n      try {\n        const novoRegistro = {\n          dataHora: serverTimestamp(),\n          status: \"Marcado\"\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid\n        });\n        console.log(\"Registro de ponto salvo com sucesso:\", novoRegistroRef.key);\n\n        // Atualiza a lista de registros na interface do usuário\n        this.registros.push({\n          ...novoRegistro,\n          id: novoRegistroRef.key\n        });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    }\n  },\n  async created() {\n    const auth = getAuth();\n    const user = auth.currentUser;\n    if (!user) {\n      console.error(\"Usuário não autenticado\");\n      return;\n    }\n    const db = getDatabase();\n    const pontoRef = ref(db, \"pontos\");\n\n    // Consulta os registros de ponto do usuário no Realtime Database\n    // Este exemplo apenas carrega os últimos 10 registros, você pode ajustar conforme necessário\n    const snapshot = await get(pontoRef, \"value\");\n    const registros = [];\n    if (snapshot.exists()) {\n      snapshot.forEach(childSnapshot => {\n        const key = childSnapshot.key;\n        const data = childSnapshot.val();\n        registros.push({\n          key,\n          ...data\n        });\n      });\n    }\n    this.registros = registros;\n  }\n};","map":{"version":3,"names":["getAuth","getDatabase","ref","push","set","serverTimestamp","data","registros","methods","marcarPonto","auth","user","currentUser","console","error","db","pontoRef","novoRegistro","dataHora","status","novoRegistroRef","userId","uid","log","key","id","message","created","snapshot","get","exists","forEach","childSnapshot","val"],"sources":["/home/alexandre/code/ponto-eletronico/src/components/ClockInClockOut.vue"],"sourcesContent":["<!-- PontoEletronico.vue -->\n<template>\n  <div>\n    <h1>Marcação de Ponto Eletrônico</h1>\n    <button @click=\"marcarPonto\">Marcar Ponto</button>\n    <ul>\n      <li v-for=\"registro in registros\" :key=\"registro.id\">\n        {{ registro.dataHora }} - {{ registro.status }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getAuth } from \"firebase/auth\";\nimport {\n  getDatabase,\n  ref,\n  push,\n  set,\n  serverTimestamp,\n} from \"firebase/database\";\n\nexport default {\n  data() {\n    return {\n      registros: [],\n    };\n  },\n  methods: {\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      if (!user) {\n        console.error(\"Usuário não autenticado\");\n        return;\n      }\n\n      const db = getDatabase();\n      const pontoRef = ref(db, \"pontos\");\n\n      try {\n        const novoRegistro = {\n          dataHora: serverTimestamp(),\n          status: \"Marcado\",\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid,\n        });\n\n        console.log(\n          \"Registro de ponto salvo com sucesso:\",\n          novoRegistroRef.key\n        );\n\n        // Atualiza a lista de registros na interface do usuário\n        this.registros.push({ ...novoRegistro, id: novoRegistroRef.key });\n      } catch (error) {\n        console.error(\"Erro ao marcar ponto:\", error.message);\n      }\n    },\n  },\n  async created() {\n    const auth = getAuth();\n    const user = auth.currentUser;\n\n    if (!user) {\n      console.error(\"Usuário não autenticado\");\n      return;\n    }\n\n    const db = getDatabase();\n    const pontoRef = ref(db, \"pontos\");\n\n    // Consulta os registros de ponto do usuário no Realtime Database\n    // Este exemplo apenas carrega os últimos 10 registros, você pode ajustar conforme necessário\n    const snapshot = await get(pontoRef, \"value\");\n    const registros = [];\n\n    if (snapshot.exists()) {\n      snapshot.forEach((childSnapshot) => {\n        const key = childSnapshot.key;\n        const data = childSnapshot.val();\n        registros.push({ key, ...data });\n      });\n    }\n\n    this.registros = registros;\n  },\n};\n</script>\n"],"mappings":";AAcA,SAASA,OAAM,QAAS,eAAe;AACvC,SACEC,WAAW,EACXC,GAAG,EACHC,IAAI,EACJC,GAAG,EACHC,eAAe,QACV,mBAAmB;AAE1B,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE;IACb,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,WAAWA,CAAA,EAAG;MAClB,MAAMC,IAAG,GAAIV,OAAO,CAAC,CAAC;MACtB,MAAMW,IAAG,GAAID,IAAI,CAACE,WAAW;MAE7B,IAAI,CAACD,IAAI,EAAE;QACTE,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAC;QACxC;MACF;MAEA,MAAMC,EAAC,GAAId,WAAW,CAAC,CAAC;MACxB,MAAMe,QAAO,GAAId,GAAG,CAACa,EAAE,EAAE,QAAQ,CAAC;MAElC,IAAI;QACF,MAAME,YAAW,GAAI;UACnBC,QAAQ,EAAEb,eAAe,CAAC,CAAC;UAC3Bc,MAAM,EAAE;QACV,CAAC;;QAED;QACA,MAAMC,eAAc,GAAIjB,IAAI,CAACa,QAAQ,CAAC;QACtC,MAAMZ,GAAG,CAACgB,eAAe,EAAE;UACzB,GAAGH,YAAY;UACfI,MAAM,EAAEV,IAAI,CAACW;QACf,CAAC,CAAC;QAEFT,OAAO,CAACU,GAAG,CACT,sCAAsC,EACtCH,eAAe,CAACI,GAClB,CAAC;;QAED;QACA,IAAI,CAACjB,SAAS,CAACJ,IAAI,CAAC;UAAE,GAAGc,YAAY;UAAEQ,EAAE,EAAEL,eAAe,CAACI;QAAI,CAAC,CAAC;MACnE,EAAE,OAAOV,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAACY,OAAO,CAAC;MACvD;IACF;EACF,CAAC;EACD,MAAMC,OAAOA,CAAA,EAAG;IACd,MAAMjB,IAAG,GAAIV,OAAO,CAAC,CAAC;IACtB,MAAMW,IAAG,GAAID,IAAI,CAACE,WAAW;IAE7B,IAAI,CAACD,IAAI,EAAE;MACTE,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAC;MACxC;IACF;IAEA,MAAMC,EAAC,GAAId,WAAW,CAAC,CAAC;IACxB,MAAMe,QAAO,GAAId,GAAG,CAACa,EAAE,EAAE,QAAQ,CAAC;;IAElC;IACA;IACA,MAAMa,QAAO,GAAI,MAAMC,GAAG,CAACb,QAAQ,EAAE,OAAO,CAAC;IAC7C,MAAMT,SAAQ,GAAI,EAAE;IAEpB,IAAIqB,QAAQ,CAACE,MAAM,CAAC,CAAC,EAAE;MACrBF,QAAQ,CAACG,OAAO,CAAEC,aAAa,IAAK;QAClC,MAAMR,GAAE,GAAIQ,aAAa,CAACR,GAAG;QAC7B,MAAMlB,IAAG,GAAI0B,aAAa,CAACC,GAAG,CAAC,CAAC;QAChC1B,SAAS,CAACJ,IAAI,CAAC;UAAEqB,GAAG;UAAE,GAAGlB;QAAK,CAAC,CAAC;MAClC,CAAC,CAAC;IACJ;IAEA,IAAI,CAACC,SAAQ,GAAIA,SAAS;EAC5B;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
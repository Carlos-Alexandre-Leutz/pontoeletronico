{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth } from 'firebase/auth';\nimport { getDatabase, ref, push, set } from 'firebase/database';\nimport { getStorage, ref as storageRef, uploadString, getDownloadURL } from 'firebase/storage';\nexport default {\n  data() {\n    return {\n      registros: [],\n      arquivo: null\n    };\n  },\n  methods: {\n    handleFileUpload(event) {\n      this.arquivo = event.target.files[0];\n    },\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n      if (!user || !this.arquivo) {\n        console.error('Usuário não autenticado ou nenhum arquivo selecionado');\n        return;\n      }\n      const db = getDatabase();\n      const pontoRef = ref(db, 'pontos');\n      try {\n        const novoRegistro = {\n          dataHora: new Date().toISOString(),\n          status: 'Marcado'\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid\n        });\n        console.log('Registro de ponto salvo com sucesso:', novoRegistroRef.key);\n\n        // Salva o arquivo no Storage\n        const storage = getStorage();\n        const storagePath = `ponto-eletronico/${user.uid}/${novoRegistroRef.key}.txt`;\n        const storageRef = storageRef(storage, storagePath);\n        await uploadString(storageRef, 'Conteúdo do arquivo');\n\n        // Obtém o URL de download do arquivo no Storage\n        const downloadUrl = await getDownloadURL(storageRef);\n\n        // Atualiza a lista de registros na interface do usuário com o URL de download\n        this.registros.push({\n          ...novoRegistro,\n          id: novoRegistroRef.key,\n          downloadUrl\n        });\n      } catch (error) {\n        console.error('Erro ao marcar ponto:', error.message);\n      }\n    }\n  }\n};","map":{"version":3,"names":["getAuth","getDatabase","ref","push","set","getStorage","storageRef","uploadString","getDownloadURL","data","registros","arquivo","methods","handleFileUpload","event","target","files","marcarPonto","auth","user","currentUser","console","error","db","pontoRef","novoRegistro","dataHora","Date","toISOString","status","novoRegistroRef","userId","uid","log","key","storage","storagePath","downloadUrl","id","message"],"sources":["/home/alexandre/code/ponto-eletronico/src/components/ClockInClockOut.vue"],"sourcesContent":["<!-- PontoEletronico.vue -->\n<template>\n  <div>\n    <h1>Marcação de Ponto Eletrônico</h1>\n    <input type=\"file\" @change=\"handleFileUpload\" />\n    <button @click=\"marcarPonto\">Marcar Ponto</button>\n    <ul>\n      <li v-for=\"registro in registros\" :key=\"registro.id\">\n        {{ registro.dataHora }} - {{ registro.status }} - {{ registro.downloadUrl }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { getAuth } from 'firebase/auth';\nimport { getDatabase, ref, push, set } from 'firebase/database';\nimport { getStorage, ref as storageRef, uploadString, getDownloadURL } from 'firebase/storage';\n\nexport default {\n  data() {\n    return {\n      registros: [],\n      arquivo: null,\n    };\n  },\n  methods: {\n    handleFileUpload(event) {\n      this.arquivo = event.target.files[0];\n    },\n    async marcarPonto() {\n      const auth = getAuth();\n      const user = auth.currentUser;\n\n      if (!user || !this.arquivo) {\n        console.error('Usuário não autenticado ou nenhum arquivo selecionado');\n        return;\n      }\n\n      const db = getDatabase();\n      const pontoRef = ref(db, 'pontos');\n\n      try {\n        const novoRegistro = {\n          dataHora: new Date().toISOString(),\n          status: 'Marcado',\n        };\n\n        // Adiciona um novo registro no Realtime Database\n        const novoRegistroRef = push(pontoRef);\n        await set(novoRegistroRef, {\n          ...novoRegistro,\n          userId: user.uid,\n        });\n\n        console.log('Registro de ponto salvo com sucesso:', novoRegistroRef.key);\n\n        // Salva o arquivo no Storage\n        const storage = getStorage();\n        const storagePath = `ponto-eletronico/${user.uid}/${novoRegistroRef.key}.txt`;\n        const storageRef = storageRef(storage, storagePath);\n        await uploadString(storageRef, 'Conteúdo do arquivo');\n\n        // Obtém o URL de download do arquivo no Storage\n        const downloadUrl = await getDownloadURL(storageRef);\n\n        // Atualiza a lista de registros na interface do usuário com o URL de download\n        this.registros.push({ ...novoRegistro, id: novoRegistroRef.key, downloadUrl });\n      } catch (error) {\n        console.error('Erro ao marcar ponto:', error.message);\n      }\n    },\n  },\n};\n</script>\n"],"mappings":";AAeA,SAASA,OAAM,QAAS,eAAe;AACvC,SAASC,WAAW,EAAEC,GAAG,EAAEC,IAAI,EAAEC,GAAE,QAAS,mBAAmB;AAC/D,SAASC,UAAU,EAAEH,GAAE,IAAKI,UAAU,EAAEC,YAAY,EAAEC,cAAa,QAAS,kBAAkB;AAE9F,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE;IACX,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,gBAAgBA,CAACC,KAAK,EAAE;MACtB,IAAI,CAACH,OAAM,GAAIG,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IACtC,CAAC;IACD,MAAMC,WAAWA,CAAA,EAAG;MAClB,MAAMC,IAAG,GAAIlB,OAAO,CAAC,CAAC;MACtB,MAAMmB,IAAG,GAAID,IAAI,CAACE,WAAW;MAE7B,IAAI,CAACD,IAAG,IAAK,CAAC,IAAI,CAACR,OAAO,EAAE;QAC1BU,OAAO,CAACC,KAAK,CAAC,uDAAuD,CAAC;QACtE;MACF;MAEA,MAAMC,EAAC,GAAItB,WAAW,CAAC,CAAC;MACxB,MAAMuB,QAAO,GAAItB,GAAG,CAACqB,EAAE,EAAE,QAAQ,CAAC;MAElC,IAAI;QACF,MAAME,YAAW,GAAI;UACnBC,QAAQ,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;UAClCC,MAAM,EAAE;QACV,CAAC;;QAED;QACA,MAAMC,eAAc,GAAI3B,IAAI,CAACqB,QAAQ,CAAC;QACtC,MAAMpB,GAAG,CAAC0B,eAAe,EAAE;UACzB,GAAGL,YAAY;UACfM,MAAM,EAAEZ,IAAI,CAACa;QACf,CAAC,CAAC;QAEFX,OAAO,CAACY,GAAG,CAAC,sCAAsC,EAAEH,eAAe,CAACI,GAAG,CAAC;;QAExE;QACA,MAAMC,OAAM,GAAI9B,UAAU,CAAC,CAAC;QAC5B,MAAM+B,WAAU,GAAK,oBAAmBjB,IAAI,CAACa,GAAI,IAAGF,eAAe,CAACI,GAAI,MAAK;QAC7E,MAAM5B,UAAS,GAAIA,UAAU,CAAC6B,OAAO,EAAEC,WAAW,CAAC;QACnD,MAAM7B,YAAY,CAACD,UAAU,EAAE,qBAAqB,CAAC;;QAErD;QACA,MAAM+B,WAAU,GAAI,MAAM7B,cAAc,CAACF,UAAU,CAAC;;QAEpD;QACA,IAAI,CAACI,SAAS,CAACP,IAAI,CAAC;UAAE,GAAGsB,YAAY;UAAEa,EAAE,EAAER,eAAe,CAACI,GAAG;UAAEG;QAAY,CAAC,CAAC;MAChF,EAAE,OAAOf,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAACiB,OAAO,CAAC;MACvD;IACF;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}